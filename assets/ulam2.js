const Y=document.getElementById("ulamCanvas"),c=Y.getContext("2d"),q=document.getElementById("modeSelect");let X=0,L=0,T=20,u=1,$=0,y=0;const h=window.devicePixelRatio||1;let x=0,b=0;const le=.92;let C=!1,D=0,G=0,H=0,I=0,Q=-1,O=1;const k=new Map,d=document.createElement("div");d.style.position="fixed";d.style.background="rgba(0,0,0,0.85)";d.style.color="#0f0";d.style.padding="6px 10px";d.style.borderRadius="5px";d.style.fontFamily="monospace";d.style.fontSize="13px";d.style.pointerEvents="none";d.style.whiteSpace="pre";d.style.display="none";d.style.zIndex=1e4;document.body.appendChild(d);const R=new Map;function W(e){if(e<2)return!1;if(R.has(e))return R.get(e);if(e===2)return R.set(e,!0),!0;if(e%2===0)return R.set(e,!1),!1;const n=Math.floor(Math.sqrt(e));for(let t=3;t<=n;t+=2)if(e%t===0)return R.set(e,!1),!1;return R.set(e,!0),!0}function F(e){if(e<2)return 0;let n=0;const t=Math.floor(Math.sqrt(e));for(let o=2;o<=t;o++)e%o===0&&(n++,o!==e/o&&n++);return n}function J(e){const n=new Map;let t=e;for(let o=2;o*o<=t;o++)for(;t%o===0;)n.set(o,(n.get(o)||0)+1),t=Math.floor(t/o);return t>1&&n.set(t,(n.get(t)||0)+1),n}function U(e){if(!e||e.size===0)return"(none)";const n=[];for(const[t,o]of e.entries())n.push(o>1?`${t}^${o}`:`${t}`);return n.join(" × ")}function ce(e){if(e<=2||e%2!==0)return 0;let n=0;for(let t=2;t<=e/2;t++)W(t)&&W(e-t)&&n++;return n}const ge=.6601618158;function pe(e){if(e<=2||e%2!==0)return 1;const n=Math.log(e);if(n===0)return 1;let t=1;const o=J(e);for(const[s]of o.entries())s>2&&(t*=(s-1)/(s-2));return 2*ge*(e/(n*n))*t}function V(e,n){if(e===0&&n===0)return 1;const t=Math.max(Math.abs(e),Math.abs(n)),o=2*t,s=(2*t+1)**2;let l;return n===t?l=s-(t-e):e===-t?l=s-o-(t-n):n===-t?l=s-2*o-(e+t):l=s-3*o-(n+t),l}function Z(e,n){const t=Math.abs(e),o=Math.abs(n);return t===0&&o===0?!1:t===0?W(o)&&o%4===3:o===0?W(t)&&t%4===3:W(t*t+o*o)}function _(e,n){if(e===0&&n===0)return!1;const t=e*e-e*n+n*n;return t<=1?!1:W(t)}const ee=Math.sqrt(3);function K(e,n,t){const o=t*ee*(e+n/2),s=t*(3/2*n);return[o,s]}function B(e,n,t){const o=.6666666666666666*n/t,s=e/(t*ee)-o/2,l=o,r=-s-l;let i=Math.round(s),a=Math.round(r),f=Math.round(l);const m=Math.abs(i-s),g=Math.abs(a-r),M=Math.abs(f-l);return m>g&&m>M?i=-a-f:g>M?a=-i-f:f=-i-a,[i,f]}function re(e,n,t,o,s,l,r){e.beginPath();for(let i=0;i<6;i++){const a=Math.PI/6+i*Math.PI/3,f=o*Math.cos(a),m=o*Math.sin(a);i===0?e.moveTo(n+f,t+m):e.lineTo(n+f,t+m)}e.closePath(),s&&(e.fillStyle=s,e.fill()),l&&(e.strokeStyle=l,e.lineWidth=r,e.stroke())}function ae(e,n){const t=q.value.toLowerCase();if(t.includes("-comet")){let o;if(t.startsWith("ulam-")?o=V(e,n):t.startsWith("gauss-")?o=e*e+n*n:o=e*e-e*n+n*n,o<=2||o%2!==0)return"rgba(20, 20, 20, 1)";const s=ce(o),l=Math.log(o),r=240-s/(o/l**2)*120;return`hsl(${Math.max(0,Math.min(240,r))}, 90%, 55%)`}if(t.includes("ulam-")){const o=V(e,n);if(t==="ulam-green")return W(o)?"#00ff00":"transparent";if(o===1)return"black";if(W(o))return"#ffffff";const s=F(o);let l=Math.max(0,255-s*12);return l=Math.min(255,l),`rgb(${l},${Math.floor(l/2)},0)`}else if(t.includes("gauss-")){const o=e,s=n,l=o*o+s*s;if(t==="gauss-green")return Z(o,s)?"#00ff00":"transparent";{if(Z(o,s))return"#ffffff";if(l<=1)return"black";const r=F(l);let i=Math.max(0,255-r*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}else if(t.includes("eisen")){const o=e,s=n,l=o*o-o*s+s*s;if(t.includes("eisen-green"))return _(o,s)?"#00ff00":"transparent";{if(_(o,s))return"#ffffff";if(l<=1)return"black";const r=F(l);let i=Math.max(0,255-r*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}return"transparent"}const E=5,ue=.05,fe=12;function S(){k.clear();const e=q.value,n=e.toLowerCase().includes("eisen"),t=-$/u,o=(X-$)/u,s=-y/u,l=(L-y)/u;if(n){const r=T,i=r*ee,a=r*2,[f,m]=B(t,s,r),[g,M]=B(o,s,r),[p,j]=B(t,l,r),[N,P]=B(o,l,r),A=Math.min(f,g,p,N)-E,me=Math.max(f,g,p,N)+E,Me=Math.min(m,M,j,P)-E,$e=Math.max(m,M,j,P)+E;for(let v=Math.floor(Me);v<=Math.ceil($e);v++)for(let w=Math.floor(A);w<=Math.ceil(me);w++){const[te,ne]=K(w,v,r);if(te>t-i&&te<o+i&&ne>s-a&&ne<l+a){const ye=`${w},${v}`;let oe,se,ie;se=w*w-w*v+v*v,oe=`${w}${v>=0?"+":""}${v}ω`,ie=ae(w,v),k.set(ye,{x:w,y:v,label:oe,value:se,color:ie})}}}else{const r=T,i=r,a=Math.floor(t/r)-E,f=Math.ceil(o/r)+E,m=Math.floor(s/i)-E,g=Math.ceil(l/i)+E;for(let M=m;M<=g;M++)for(let p=a;p<=f;p++){const j=`${p},${M}`;let N,P,A;e.toLowerCase().includes("ulam-")?(P=V(p,M),N=String(P)):(P=p*p+M*M,N=`${p}${M>=0?"+":""}${M}i`),A=ae(p,M),k.set(j,{x:p,y:M,label:N,value:P,color:A})}}}function z(){c.clearRect(0,0,X*h,L*h),c.save(),c.translate($,y),c.scale(u,u);const e=q.value.toLowerCase();if(e.includes("gauss-"))c.strokeStyle="#666",c.lineWidth=1/u,c.beginPath(),c.moveTo(-X/u,0),c.lineTo(X/u,0),c.moveTo(0,-L/u),c.lineTo(0,L/u),c.stroke();else if(e.includes("eisen")){c.strokeStyle="#666",c.lineWidth=1/u,c.beginPath();const n=Math.max(X,L)/u,[t,o]=K(n,0,1);c.moveTo(-t,-o),c.lineTo(t,o);const[s,l]=K(0,n,1);c.moveTo(-s,-l),c.lineTo(s,l),c.stroke()}if(e.includes("eisen")){const n=T;for(const t of k.values()){const[o,s]=K(t.x,t.y,n);t.color!=="transparent"&&re(c,o,s,n,t.color,null,null),re(c,o,s,n,null,"rgba(0,0,0,0.2)",1/u)}}else{const n=T;for(const t of k.values())t.color!=="transparent"&&(c.fillStyle=t.color,c.fillRect(t.x*n,t.y*n,n,n),c.strokeStyle="rgba(0,0,0,0.2)",c.lineWidth=1/u,c.strokeRect(t.x*n,t.y*n,n,n))}c.restore()}function he(){C||(Math.abs(x)>.1||Math.abs(b)>.1?($+=x,y+=b,x*=le,b*=le,S(),z()):Math.abs(x)<=.1&&Math.abs(b)<=.1&&(x!==0||b!==0)&&(x=0,b=0)),requestAnimationFrame(he)}function ve(e,n){const t=q.value,o=(e/h-$)/u,s=(n/h-y)/u;if(t.toLowerCase().includes("eisen")){const[l,r]=B(o,s,T),i=`${l},${r}`;return k.get(i)}else{const l=Math.floor(o/T),r=Math.floor(s/T);return k.get(`${l},${r}`)}}function we(e){if(C){d.style.display="none";const i=e.clientX-D,a=e.clientY-G;$=H+i*h,y=I+a*h,x=e.movementX*h,b=e.movementY*h,S(),z();return}const n=ve(e.clientX*h,e.clientY*h);if(!n){d.style.display="none";return}const t=q.value;let o="";if(t.toLowerCase().includes("-comet")){const i=n.value;let a=`n = ${i}`;if(t.startsWith("gauss-")?a=`${n.x}${n.y>=0?"+":""}${n.y}i
Norm = ${i}`:t.startsWith("eisen-")&&(a=`${n.x}${n.y>=0?"+":""}${n.y}ω
Norm = ${i}`),i<=2||i%2!==0)o=`${a}
(Odd or too small)`;else{const f=ce(i),m=pe(i),g=m>.1?f/m:0;o=`${a}
Goldbach Pairs: ${f}
Heuristic: ${m.toFixed(2)}
Ratio: ${g.toFixed(2)}`}}else if(t.toLowerCase().includes("ulam-")){const i=n.value,a=F(i),f=U(J(i));o=`n = ${i}
Factors (excluding 1,n): ${a}
Prime factorization:
${f}`}else if(t.toLowerCase().includes("gauss-")){const i=n.x,a=n.y,f=n.value,m=Z(i,a)?"Yes":"No",g=F(f),M=U(J(f));o=`${i}${a>=0?"+":""}${a}i
Gaussian prime: ${m}
Norm = ${f}
Norm factors (excl 1,norm): ${g}
Prime factorization of norm:
${M}`}else if(t.toLowerCase().includes("eisen")){const i=n.x,a=n.y,f=n.value,m=_(i,a)?"Yes":"No",g=F(f),M=U(J(f));o=`${i}${a>=0?"+":""}${a}ω
Eisenstein prime: ${m}
Norm = ${f}
Norm factors (excl 1,norm): ${g}
Prime factorization of norm:
${M}`}d.textContent=o,d.style.display="block";const s=12;let l=e.clientX+s,r=e.clientY+s;l+d.offsetWidth>window.innerWidth&&(l=e.clientX-d.offsetWidth-s),r+d.offsetHeight>window.innerHeight&&(r=e.clientY-d.offsetHeight-s),d.style.left=`${l}px`,d.style.top=`${r}px`}function xe(e){e.preventDefault();const n=e.clientX*h,t=e.clientY*h,o=-e.deltaY*.001;let s=u*(1+o);s=Math.min(Math.max(s,ue),fe);const l=(n-$)/u,r=(t-y)/u;$-=l*s-l*u,y-=r*s-r*u,u=s,S(),z()}function be(e){C=!0,D=e.clientX,G=e.clientY,H=$,I=y,x=0,b=0,Y.style.cursor="grabbing",d.style.display="none"}function Ye(){C=!1,Y.style.cursor="grab"}function Xe(e){if(e.preventDefault(),e.touches.length===2){const n=e.touches[0],t=e.touches[1];Q=Math.hypot(t.clientX-n.clientX,t.clientY-n.clientY),O=u,C=!1,d.style.display="none"}else e.touches.length===1&&(C=!0,D=e.touches[0].clientX,G=e.touches[0].clientY,H=$,I=y,x=0,b=0,d.style.display="none")}function Le(e){if(e.preventDefault(),e.touches.length===2&&Q>0){const n=e.touches[0],t=e.touches[1],o=Math.hypot(t.clientX-n.clientX,t.clientY-n.clientY),s=O*(o/Q);u=Math.min(Math.max(s,ue),fe);const l=(n.clientX+t.clientX)/2,r=(n.clientY+t.clientY)/2,i=(l*h-H)/O,a=(r*h-I)/O,f=(l*h-$)/u,m=(r*h-y)/u;$+=(f-i)*u,y+=(m-a)*u,S(),z()}else if(C&&e.touches.length===1){const n=e.touches[0].clientX-D,t=e.touches[0].clientY-G;$=H+n*h,y=I+t*h,e.touches[0].previousClientX!==void 0&&(x=(e.touches[0].clientX-e.touches[0].previousClientX)*h,b=(e.touches[0].clientY-e.touches[0].previousClientY)*h),S(),z()}}function Ce(e){Q=-1,e.touches.length===0?C=!1:e.touches.length===1&&(C=!0,D=e.touches[0].clientX,G=e.touches[0].clientY,H=$,I=y)}function de(){X=window.innerWidth,L=window.innerHeight,Y.style.width=`${X}px`,Y.style.height=`${L}px`,Y.width=X*h,Y.height=L*h,c.setTransform(h,0,0,h,0,0),$===0&&y===0&&($=X*h/2,y=L*h/2),S(),z()}q.addEventListener("change",()=>{k.clear(),S(),z()});Y.addEventListener("wheel",xe,{passive:!1});Y.addEventListener("mousedown",be);window.addEventListener("mousemove",we);window.addEventListener("mouseup",Ye);Y.addEventListener("touchstart",Xe,{passive:!1});window.addEventListener("touchmove",Le,{passive:!1});window.addEventListener("touchend",Ce);window.addEventListener("resize",de);de();he();
//# sourceMappingURL=ulam2.js.map
