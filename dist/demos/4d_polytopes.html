<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>4D Polytope Visualizer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    
    <link rel="icon" href="/assets/nymessence_logo_clean.svg" type="image/svg+xml">
    



  

    <script type="importmap">
    {
        "imports": {
            "three": "../node_modules/three/build/three.module.js",
            "three/addons/": "../node_modules/three/examples/jsm/"
        }
    }
    </script>
  <link rel="modulepreload" crossorigin href="data:application/javascript;base64,KGZ1bmN0aW9uKCl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaW5rIikucmVsTGlzdDtpZih0JiZ0LnN1cHBvcnRzJiZ0LnN1cHBvcnRzKCJtb2R1bGVwcmVsb2FkIikpcmV0dXJuO2Zvcihjb25zdCBlIG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpbmtbcmVsPSJtb2R1bGVwcmVsb2FkIl0nKSlpKGUpO25ldyBNdXRhdGlvbk9ic2VydmVyKGU9Pntmb3IoY29uc3QgciBvZiBlKWlmKHIudHlwZT09PSJjaGlsZExpc3QiKWZvcihjb25zdCBvIG9mIHIuYWRkZWROb2RlcylvLnRhZ05hbWU9PT0iTElOSyImJm8ucmVsPT09Im1vZHVsZXByZWxvYWQiJiZpKG8pfSkub2JzZXJ2ZShkb2N1bWVudCx7Y2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KTtmdW5jdGlvbiBzKGUpe2NvbnN0IHI9e307cmV0dXJuIGUuaW50ZWdyaXR5JiYoci5pbnRlZ3JpdHk9ZS5pbnRlZ3JpdHkpLGUucmVmZXJyZXJQb2xpY3kmJihyLnJlZmVycmVyUG9saWN5PWUucmVmZXJyZXJQb2xpY3kpLGUuY3Jvc3NPcmlnaW49PT0idXNlLWNyZWRlbnRpYWxzIj9yLmNyZWRlbnRpYWxzPSJpbmNsdWRlIjplLmNyb3NzT3JpZ2luPT09ImFub255bW91cyI/ci5jcmVkZW50aWFscz0ib21pdCI6ci5jcmVkZW50aWFscz0ic2FtZS1vcmlnaW4iLHJ9ZnVuY3Rpb24gaShlKXtpZihlLmVwKXJldHVybjtlLmVwPSEwO2NvbnN0IHI9cyhlKTtmZXRjaChlLmhyZWYscil9fSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlcHJlbG9hZC1wb2x5ZmlsbC5qcy5tYXAK">
  <link rel="modulepreload" crossorigin href="/assets/three.module.js">
  <link rel="modulepreload" crossorigin href="/assets/OrbitControls.js">
  
  
  <link rel="modulepreload" crossorigin href="data:application/javascript;base64,KGZ1bmN0aW9uKCl7Y29uc3Qgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaW5rIikucmVsTGlzdDtpZihvJiZvLnN1cHBvcnRzJiZvLnN1cHBvcnRzKCJtb2R1bGVwcmVsb2FkIikpcmV0dXJuO2Zvcihjb25zdCBlIG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpbmtbcmVsPSJtb2R1bGVwcmVsb2FkIl0nKSlyKGUpO25ldyBNdXRhdGlvbk9ic2VydmVyKGU9Pntmb3IoY29uc3QgdCBvZiBlKWlmKHQudHlwZT09PSJjaGlsZExpc3QiKWZvcihjb25zdCBzIG9mIHQuYWRkZWROb2RlcylzLnRhZ05hbWU9PT0iTElOSyImJnMucmVsPT09Im1vZHVsZXByZWxvYWQiJiZyKHMpfSkub2JzZXJ2ZShkb2N1bWVudCx7Y2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KTtmdW5jdGlvbiBuKGUpe2NvbnN0IHQ9e307cmV0dXJuIGUuaW50ZWdyaXR5JiYodC5pbnRlZ3JpdHk9ZS5pbnRlZ3JpdHkpLGUucmVmZXJyZXJQb2xpY3kmJih0LnJlZmVycmVyUG9saWN5PWUucmVmZXJyZXJQb2xpY3kpLGUuY3Jvc3NPcmlnaW49PT0idXNlLWNyZWRlbnRpYWxzIj90LmNyZWRlbnRpYWxzPSJpbmNsdWRlIjplLmNyb3NzT3JpZ2luPT09ImFub255bW91cyI/dC5jcmVkZW50aWFscz0ib21pdCI6dC5jcmVkZW50aWFscz0ic2FtZS1vcmlnaW4iLHR9ZnVuY3Rpb24gcihlKXtpZihlLmVwKXJldHVybjtlLmVwPSEwO2NvbnN0IHQ9bihlKTtmZXRjaChlLmhyZWYsdCl9fSkoKTsoZnVuY3Rpb24oKXtjb25zdCBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpbmsiKS5yZWxMaXN0O2lmKGkmJmkuc3VwcG9ydHMmJmkuc3VwcG9ydHMoIm1vZHVsZXByZWxvYWQiKSlyZXR1cm47Zm9yKGNvbnN0IHIgb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGlua1tyZWw9Im1vZHVsZXByZWxvYWQiXScpKW4ocik7bmV3IE11dGF0aW9uT2JzZXJ2ZXIocj0+e2Zvcihjb25zdCBlIG9mIHIpaWYoZS50eXBlPT09ImNoaWxkTGlzdCIpZm9yKGNvbnN0IHQgb2YgZS5hZGRlZE5vZGVzKXQudGFnTmFtZT09PSJMSU5LIiYmdC5yZWw9PT0ibW9kdWxlcHJlbG9hZCImJm4odCl9KS5vYnNlcnZlKGRvY3VtZW50LHtjaGlsZExpc3Q6ITAsc3VidHJlZTohMH0pO2Z1bmN0aW9uIG8ocil7Y29uc3QgZT17fTtyZXR1cm4gci5pbnRlZ3JpdHkmJihlLmludGVncml0eT1yLmludGVncml0eSksci5yZWZlcnJlclBvbGljeSYmKGUucmVmZXJyZXJQb2xpY3k9ci5yZWZlcnJlclBvbGljeSksci5jcm9zc09yaWdpbj09PSJ1c2UtY3JlZGVudGlhbHMiP2UuY3JlZGVudGlhbHM9ImluY2x1ZGUiOnIuY3Jvc3NPcmlnaW49PT0iYW5vbnltb3VzIj9lLmNyZWRlbnRpYWxzPSJvbWl0IjplLmNyZWRlbnRpYWxzPSJzYW1lLW9yaWdpbiIsZX1mdW5jdGlvbiBuKHIpe2lmKHIuZXApcmV0dXJuO3IuZXA9ITA7Y29uc3QgZT1vKHIpO2ZldGNoKHIuaHJlZixlKX19KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGVwcmVsb2FkLXBvbHlmaWxsLmpzLm1hcAo=">
  <link rel="modulepreload" crossorigin href="/assets/three.module2.js">
  <link rel="modulepreload" crossorigin href="/assets/OrbitControls2.js">
  
  <script type="module" crossorigin src="/assets/polytopes.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill.js">
  <link rel="modulepreload" crossorigin href="/assets/three.module22.js">
  <link rel="modulepreload" crossorigin href="/assets/OrbitControls22.js">
  <link rel="stylesheet" href="/assets/4d_polytopes.css">
</head>

<body>
    <!-- Main 3D canvas container -->
    <div id="container" class="canvas-container"></div>

    <!-- UI Sidebar -->
    <aside id="ui" role="complementary" aria-label="Control Panel">
        <div class="ui-content">
            <header>
                <strong>4D Polytope Visualizer</strong>
                <button id="toggleUI">Hide UI</button>
                <button id="fullscreenBtn">Full screen</button>
            </header>

            <div class="scroll-hint">â†“ Scroll for more controls</div>

            <label for="polytopeSelect">
                Select Polytope
                <select id="polytopeSelect" name="polytopeSelect">
                    <option value="4-simplex">4-simplex</option>
                    <option value="hypercube">Hypercube</option>
                    <option value="16-cell">16 Cell</option>
                    <option value="24-cell" selected>24 Cell</option>
                    <option value="120-cell">120 Cell</option>
                    <option value="600-cell">600 Cell</option>
                </select>
            </label>
            <hr />

            <label>
                <input type="checkbox" id="showVerts" checked />
                Show Vertices
            </label>
            <label>
                Vertex Color
                <input type="color" id="vertColor" value="#ffcc00" />
            </label>
            <label>
                Vertex Size
                <input type="range" id="vertSize" min="0.01" max="0.2" step="0.005" value="0.05" />
            </label>
            <hr />

            <label>
                <input type="checkbox" id="showEdges" checked />
                Show Edges
            </label>
            <label>
                Edge Color
                <input type="color" id="edgeColor" value="#44aaff" />
            </label>
            <label>
                Edge Opacity
                <input type="range" id="edgeOpacity" min="0" max="1" step="0.01" value="0.9" />
            </label>
            <hr />

            <label>
                <input type="checkbox" id="showFaces" />
                Show Faces
            </label>
            <label>
                Face Color
                <input type="color" id="faceColor" value="#aa44ff" />
            </label>
            <label>
                Face Opacity
                <input type="range" id="faceOpacity" min="0" max="1" step="0.01" value="0.3" />
            </label>
            <hr />

            <label for="projectionType">
                Projection Type
                <select id="projectionType" name="projectionType">
                    <option value="perspective" selected>Perspective</option>
                    <option value="parallel">Parallel</option>
                </select>
            </label>
            <hr />

            <strong>4D Rotations</strong>
            <label>
                XY Rotation
                <input type="range" id="rotXY" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <label>
                XZ Rotation
                <input type="range" id="rotXZ" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <label>
                YZ Rotation
                <input type="range" id="rotYZ" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <label>
                XW Rotation
                <input type="range" id="rotXW" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <label>
                YW Rotation
                <input type="range" id="rotYW" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <label>
                ZW Rotation
                <input type="range" id="rotZW" min="0" max="6.28318" step="0.01" value="0" />
            </label>
            <hr />

            <label for="renderMode">
                High-res Render Mode
                <select id="renderMode" name="renderMode">
                    <option value="png">Large PNG export</option>
                    <option value="samples">Multisample average render</option>
                </select>
            </label>
            <label>
                Resolution Multiplier
                <input type="number" id="resMult" min="1" max="4" step="1" value="2" style="width: 50px;" />
            </label>
            <label>
                Samples (multisample)
                <input type="number" id="samples" min="1" max="64" step="1" value="8" style="width: 50px;" />
            </label>
            <button id="renderBtn">Generate High-Res Image</button>
            <div id="progress" aria-live="polite" style="margin-top:8px; font-size: 12px; color: #aaa;"></div>
        </div>
    </aside>

    <footer role="contentinfo">
        Rotate 3D with mouse drag, zoom with wheel.<br />
        Use sliders to control 4D rotation planes.
    </footer>

    <!-- Remove event blocker script entirely -->
    <!-- No need for DOMContentLoaded workaround -->
    <script>
      // MOBILE TOUCH FIX: Prevent canvas from stealing scroll
        document.addEventListener('DOMContentLoaded', () => {
            const ui = document.getElementById('ui');
            const container = document.getElementById('container');

            // Prevent touchmove on canvas IF user is scrolling the UI
            let isScrollingUI = false;

            ui.addEventListener('touchstart', () => {
                isScrollingUI = true;
            }, { passive: true });

            ui.addEventListener('touchend', () => {
                setTimeout(() => { isScrollingUI = false; }, 100);
            });

            container.addEventListener('touchstart', (e) => {
                if (isScrollingUI) e.preventDefault();
            }, { passive: false });

            container.addEventListener('touchmove', (e) => {
                if (isScrollingUI) e.preventDefault();
            }, { passive: false });

            // Optional: Re-enable body scroll only for UI interaction
            ui.addEventListener('touchstart', (e) => {
                if (e.target.closest('#ui')) {
                    document.body.style.overflow = 'auto';
                }
            }, { passive: true });

            ui.addEventListener('touchend', () => {
                document.body.style.overflow = '';
            });
        });
    </script>

    <!-- Main app script -->
    
</body>
</html>
