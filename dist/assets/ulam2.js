const Y=document.getElementById("ulamCanvas"),a=Y.getContext("2d"),q=document.getElementById("modeSelect");let X=0,L=0,S=20,u=1,$=0,y=0;const h=window.devicePixelRatio||1;let x=0,b=0;const re=.92;let C=!1,D=0,G=0,H=0,I=0,Q=-1,O=1;const k=new Map,d=document.createElement("div");d.style.position="fixed";d.style.background="rgba(0,0,0,0.85)";d.style.color="#0f0";d.style.padding="6px 10px";d.style.borderRadius="5px";d.style.fontFamily="monospace";d.style.fontSize="13px";d.style.pointerEvents="none";d.style.whiteSpace="pre";d.style.display="none";d.style.zIndex=1e4;document.body.appendChild(d);const R=new Map;function W(e){if(e<2)return!1;if(R.has(e))return R.get(e);if(e===2)return R.set(e,!0),!0;if(e%2===0)return R.set(e,!1),!1;const n=Math.floor(Math.sqrt(e));for(let t=3;t<=n;t+=2)if(e%t===0)return R.set(e,!1),!1;return R.set(e,!0),!0}function F(e){if(e<2)return 0;let n=0;const t=Math.floor(Math.sqrt(e));for(let o=2;o<=t;o++)e%o===0&&(n++,o!==e/o&&n++);return n}function J(e){const n=new Map;let t=e;for(let o=2;o*o<=t;o++)for(;t%o===0;)n.set(o,(n.get(o)||0)+1),t=Math.floor(t/o);return t>1&&n.set(t,(n.get(t)||0)+1),n}function U(e){if(!e||e.size===0)return"(none)";const n=[];for(const[t,o]of e.entries())n.push(o>1?`${t}^${o}`:`${t}`);return n.join(" × ")}function ae(e){if(e<=2||e%2!==0)return 0;let n=0;for(let t=2;t<=e/2;t++)W(t)&&W(e-t)&&n++;return n}const ge=.6601618158;function pe(e){if(e<=2||e%2!==0)return 1;const n=Math.log(e);if(n===0)return 1;let t=1;const o=J(e);for(const[s]of o.entries())s>2&&(t*=(s-1)/(s-2));return 2*ge*(e/(n*n))*t}function V(e,n){if(e===0&&n===0)return 1;const t=Math.max(Math.abs(e),Math.abs(n)),o=2*t,s=(2*t+1)**2;let r;return n===t?r=s-(t-e):e===-t?r=s-o-(t-n):n===-t?r=s-2*o-(e+t):r=s-3*o-(n+t),r}function Z(e,n){const t=Math.abs(e),o=Math.abs(n);return t===0&&o===0?!1:t===0?W(o)&&o%4===3:o===0?W(t)&&t%4===3:W(t*t+o*o)}function _(e,n){if(e===0&&n===0)return!1;const t=e*e-e*n+n*n;return t<=1?!1:W(t)}const ee=Math.sqrt(3);function K(e,n,t){const o=t*ee*(e+n/2),s=t*(3/2*n);return[o,s]}function B(e,n,t){const o=.6666666666666666*n/t,s=e/(t*ee)-o/2,r=o,l=-s-r;let i=Math.round(s),c=Math.round(l),f=Math.round(r);const m=Math.abs(i-s),g=Math.abs(c-l),M=Math.abs(f-r);return m>g&&m>M?i=-c-f:g>M?c=-i-f:f=-i-c,[i,f]}function le(e,n,t,o,s,r,l){e.beginPath();for(let i=0;i<6;i++){const c=Math.PI/6+i*Math.PI/3,f=o*Math.cos(c),m=o*Math.sin(c);i===0?e.moveTo(n+f,t+m):e.lineTo(n+f,t+m)}e.closePath(),s&&(e.fillStyle=s,e.fill()),r&&(e.strokeStyle=r,e.lineWidth=l,e.stroke())}function ce(e,n){const t=q.value.toLowerCase();if(t.includes("-comet")){let o;if(t.startsWith("ulam-")?o=V(e,n):t.startsWith("gauss-")?o=e*e+n*n:o=e*e-e*n+n*n,o<=2||o%2!==0)return"rgba(20, 20, 20, 1)";const s=ae(o),r=Math.log(o),l=240-s/(o/r**2)*120;return`hsl(${Math.max(0,Math.min(240,l))}, 90%, 55%)`}if(t.includes("ulam-")){const o=V(e,n);if(t==="ulam-green")return W(o)?"#00ff00":"transparent";if(o===1)return"black";if(W(o))return"#ffffff";const s=F(o);let r=Math.max(0,255-s*12);return r=Math.min(255,r),`rgb(${r},${Math.floor(r/2)},0)`}else if(t.includes("gauss-")){const o=e,s=n,r=o*o+s*s;if(t==="gauss-green")return Z(o,s)?"#00ff00":"transparent";{if(Z(o,s))return"#ffffff";if(r<=1)return"black";const l=F(r);let i=Math.max(0,255-l*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}else if(t.includes("eisen")){const o=e,s=n,r=o*o-o*s+s*s;if(t.includes("eisen-green"))return _(o,s)?"#00ff00":"transparent";{if(_(o,s))return"#ffffff";if(r<=1)return"black";const l=F(r);let i=Math.max(0,255-l*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}return"transparent"}const E=5,ue=.05,fe=12;function T(){k.clear();const e=q.value,n=e.toLowerCase().includes("eisen"),t=-$/u,o=(X-$)/u,s=-y/u,r=(L-y)/u;if(n){const l=S,i=l*ee,c=l*2,[f,m]=B(t,s,l),[g,M]=B(o,s,l),[p,j]=B(t,r,l),[N,P]=B(o,r,l),A=Math.min(f,g,p,N)-E,me=Math.max(f,g,p,N)+E,Me=Math.min(m,M,j,P)-E,$e=Math.max(m,M,j,P)+E;for(let v=Math.floor(Me);v<=Math.ceil($e);v++)for(let w=Math.floor(A);w<=Math.ceil(me);w++){const[te,ne]=K(w,v,l);if(te>t-i&&te<o+i&&ne>s-c&&ne<r+c){const ye=`${w},${v}`;let oe,se,ie;se=w*w-w*v+v*v,oe=`${w}${v>=0?"+":""}${v}ω`,ie=ce(w,v),k.set(ye,{x:w,y:v,label:oe,value:se,color:ie})}}}else{const l=S,i=l,c=Math.floor(t/l)-E,f=Math.ceil(o/l)+E,m=Math.floor(s/i)-E,g=Math.ceil(r/i)+E;for(let M=m;M<=g;M++)for(let p=c;p<=f;p++){const j=`${p},${M}`;let N,P,A;e.toLowerCase().includes("ulam-")?(P=V(p,M),N=String(P)):(P=p*p+M*M,N=`${p}${M>=0?"+":""}${M}i`),A=ce(p,M),k.set(j,{x:p,y:M,label:N,value:P,color:A})}}}function z(){a.clearRect(0,0,X*h,L*h),a.save(),a.translate($,y),a.scale(u,u);const e=q.value.toLowerCase();if(e.includes("gauss-"))a.strokeStyle="#666",a.lineWidth=1/u,a.beginPath(),a.moveTo(-X/u,0),a.lineTo(X/u,0),a.moveTo(0,-L/u),a.lineTo(0,L/u),a.stroke();else if(e.includes("eisen")){a.strokeStyle="#666",a.lineWidth=1/u,a.beginPath();const n=Math.max(X,L)/u,[t,o]=K(n,0,1);a.moveTo(-t,-o),a.lineTo(t,o);const[s,r]=K(0,n,1);a.moveTo(-s,-r),a.lineTo(s,r),a.stroke()}if(e.includes("eisen")){const n=S;for(const t of k.values()){const[o,s]=K(t.x,t.y,n);t.color!=="transparent"&&le(a,o,s,n,t.color,null,null),le(a,o,s,n,null,"rgba(0,0,0,0.2)",1/u)}}else{const n=S;for(const t of k.values())t.color!=="transparent"&&(a.fillStyle=t.color,a.fillRect(t.x*n,t.y*n,n,n),a.strokeStyle="rgba(0,0,0,0.2)",a.lineWidth=1/u,a.strokeRect(t.x*n,t.y*n,n,n))}a.restore()}function he(){C||(Math.abs(x)>.1||Math.abs(b)>.1?($+=x,y+=b,x*=re,b*=re,T(),z()):Math.abs(x)<=.1&&Math.abs(b)<=.1&&(x!==0||b!==0)&&(x=0,b=0)),requestAnimationFrame(he)}function ve(e,n){const t=q.value,o=(e/h-$)/u,s=(n/h-y)/u;if(t.toLowerCase().includes("eisen")){const[r,l]=B(o,s,S),i=`${r},${l}`;return k.get(i)}else{const r=Math.floor(o/S),l=Math.floor(s/S);return k.get(`${r},${l}`)}}function we(e){if(C){d.style.display="none";const i=e.clientX-D,c=e.clientY-G;$=H+i*h,y=I+c*h,x=e.movementX*h,b=e.movementY*h,T(),z();return}const n=ve(e.clientX*h,e.clientY*h);if(!n){d.style.display="none";return}const t=q.value;let o="";if(t.toLowerCase().includes("-comet")){const i=n.value;let c=`n = ${i}`;if(t.startsWith("gauss-")?c=`${n.x}${n.y>=0?"+":""}${n.y}i
Norm = ${i}`:t.startsWith("eisen-")&&(c=`${n.x}${n.y>=0?"+":""}${n.y}ω
Norm = ${i}`),i<=2||i%2!==0)o=`${c}
(Odd or too small)`;else{const f=ae(i),m=pe(i),g=m>.1?f/m:0;o=`${c}
Goldbach Pairs: ${f}
Heuristic: ${m.toFixed(2)}
Ratio: ${g.toFixed(2)}`}}else if(t.toLowerCase().includes("ulam-")){const i=n.value,c=F(i),f=U(J(i));o=`n = ${i}
Factors (excluding 1,n): ${c}
Prime factorization:
${f}`}else if(t.toLowerCase().includes("gauss-")){const i=n.x,c=n.y,f=n.value,m=Z(i,c)?"Yes":"No",g=F(f),M=U(J(f));o=`${i}${c>=0?"+":""}${c}i
Gaussian prime: ${m}
Norm = ${f}
Norm factors (excl 1,norm): ${g}
Prime factorization of norm:
${M}`}else if(t.toLowerCase().includes("eisen")){const i=n.x,c=n.y,f=n.value,m=_(i,c)?"Yes":"No",g=F(f),M=U(J(f));o=`${i}${c>=0?"+":""}${c}ω
Eisenstein prime: ${m}
Norm = ${f}
Norm factors (excl 1,norm): ${g}
Prime factorization of norm:
${M}`}d.textContent=o,d.style.display="block";const s=12;let r=e.clientX+s,l=e.clientY+s;r+d.offsetWidth>window.innerWidth&&(r=e.clientX-d.offsetWidth-s),l+d.offsetHeight>window.innerHeight&&(l=e.clientY-d.offsetHeight-s),d.style.left=`${r}px`,d.style.top=`${l}px`}function xe(e){e.preventDefault();const n=e.clientX*h,t=e.clientY*h,o=-e.deltaY*.001;let s=u*(1+o);s=Math.min(Math.max(s,ue),fe);const r=(n-$)/u,l=(t-y)/u;$-=r*s-r*u,y-=l*s-l*u,u=s,T(),z()}function be(e){C=!0,D=e.clientX,G=e.clientY,H=$,I=y,x=0,b=0,Y.style.cursor="grabbing",d.style.display="none"}function Ye(){C=!1,Y.style.cursor="grab"}function Xe(e){if(e.preventDefault(),e.touches.length===2){const n=e.touches[0],t=e.touches[1];Q=Math.hypot(t.clientX-n.clientX,t.clientY-n.clientY),O=u,C=!1,d.style.display="none"}else e.touches.length===1&&(C=!0,D=e.touches[0].clientX,G=e.touches[0].clientY,H=$,I=y,x=0,b=0,d.style.display="none")}function Le(e){if(e.preventDefault(),e.touches.length===2&&Q>0){const n=e.touches[0],t=e.touches[1],o=Math.hypot(t.clientX-n.clientX,t.clientY-n.clientY),s=O*(o/Q);u=Math.min(Math.max(s,ue),fe);const r=(n.clientX+t.clientX)/2,l=(n.clientY+t.clientY)/2,i=(r*h-H)/O,c=(l*h-I)/O,f=(r*h-$)/u,m=(l*h-y)/u;$+=(f-i)*u,y+=(m-c)*u,T(),z()}else if(C&&e.touches.length===1){const n=e.touches[0].clientX-D,t=e.touches[0].clientY-G;$=H+n*h,y=I+t*h,e.touches[0].previousClientX!==void 0&&(x=(e.touches[0].clientX-e.touches[0].previousClientX)*h,b=(e.touches[0].clientY-e.touches[0].previousClientY)*h),T(),z()}}function Ce(e){Q=-1,e.touches.length===0?C=!1:e.touches.length===1&&(C=!0,D=e.touches[0].clientX,G=e.touches[0].clientY,H=$,I=y)}function de(){X=window.innerWidth,L=window.innerHeight,Y.style.width=`${X}px`,Y.style.height=`${L}px`,Y.width=X*h,Y.height=L*h,a.setTransform(h,0,0,h,0,0),$===0&&y===0&&($=X*h/2,y=L*h/2),T(),z()}q.addEventListener("change",()=>{k.clear(),T(),z()});Y.addEventListener("wheel",xe,{passive:!1});Y.addEventListener("mousedown",be);window.addEventListener("mousemove",we);window.addEventListener("mouseup",Ye);Y.addEventListener("touchstart",Xe,{passive:!1});window.addEventListener("touchmove",Le,{passive:!1});window.addEventListener("touchend",Ce);window.addEventListener("resize",de);de();he();
//# sourceMappingURL=ulam2.js.map
