const Y=document.getElementById("ulamCanvas"),c=Y.getContext("2d"),q=document.getElementById("modeSelect");let X=0,L=0,T=20,f=1,$=0,g=0;const h=window.devicePixelRatio||1;let x=0,b=0;const lt=.92;let C=!1,j=0,A=0,H=0,I=0,Q=-1,O=1;const k=new Map,d=document.createElement("div");d.style.position="fixed";d.style.background="rgba(0,0,0,0.85)";d.style.color="#0f0";d.style.padding="6px 10px";d.style.borderRadius="5px";d.style.fontFamily="monospace";d.style.fontSize="13px";d.style.pointerEvents="none";d.style.whiteSpace="pre";d.style.display="none";d.style.zIndex=1e4;document.body.appendChild(d);const R=new Map;function P(t){if(t<2)return!1;if(R.has(t))return R.get(t);if(t===2)return R.set(t,!0),!0;if(t%2===0)return R.set(t,!1),!1;const n=Math.floor(Math.sqrt(t));for(let e=3;e<=n;e+=2)if(t%e===0)return R.set(t,!1),!1;return R.set(t,!0),!0}function F(t){if(t<2)return 0;let n=0;const e=Math.floor(Math.sqrt(t));for(let o=2;o<=e;o++)t%o===0&&(n++,o!==t/o&&n++);return n}function J(t){const n=new Map;let e=t;for(let o=2;o*o<=e;o++)for(;e%o===0;)n.set(o,(n.get(o)||0)+1),e=Math.floor(e/o);return e>1&&n.set(e,(n.get(e)||0)+1),n}function U(t){if(!t||t.size===0)return"(none)";const n=[];for(const[e,o]of t.entries())n.push(o>1?`${e}^${o}`:`${e}`);return n.join(" × ")}function ct(t){if(t<=2||t%2!==0)return 0;let n=0;for(let e=2;e<=t/2;e++)P(e)&&P(t-e)&&n++;return n}const yt=.6601618158;function pt(t){if(t<=2||t%2!==0)return 1;const n=Math.log(t);if(n===0)return 1;let e=1;const o=J(t);for(const[s]of o.entries())s>2&&(e*=(s-1)/(s-2));return 2*yt*(t/(n*n))*e}function V(t,n){if(t===0&&n===0)return 1;const e=Math.max(Math.abs(t),Math.abs(n)),o=2*e,s=(2*e+1)**2;let l;return n===e?l=s-(e-t):t===-e?l=s-o-(e-n):n===-e?l=s-2*o-(t+e):l=s-3*o-(n+e),l}function Z(t,n){const e=Math.abs(t),o=Math.abs(n);return e===0&&o===0?!1:e===0?P(o)&&o%4===3:o===0?P(e)&&e%4===3:P(e*e+o*o)}function _(t,n){if(t===0&&n===0)return!1;const e=t*t-t*n+n*n;return e<=1?!1:P(e)}const tt=Math.sqrt(3);function K(t,n,e){const o=e*tt*(t+n/2),s=e*(3/2*n);return[o,s]}function D(t,n,e){const o=.6666666666666666*n/e,s=t/(e*tt)-o/2,l=o,r=-s-l;let i=Math.round(s),a=Math.round(r),u=Math.round(l);const m=Math.abs(i-s),y=Math.abs(a-r),M=Math.abs(u-l);return m>y&&m>M?i=-a-u:y>M?a=-i-u:u=-i-a,[i,u]}function rt(t,n,e,o,s,l,r){t.beginPath();for(let i=0;i<6;i++){const a=Math.PI/6+i*Math.PI/3,u=o*Math.cos(a),m=o*Math.sin(a);i===0?t.moveTo(n+u,e+m):t.lineTo(n+u,e+m)}t.closePath(),s&&(t.fillStyle=s,t.fill()),l&&(t.strokeStyle=l,t.lineWidth=r,t.stroke())}function at(t,n){const e=q.value.toLowerCase();if(e.includes("-comet")){let o;if(e.startsWith("ulam-")?o=V(t,n):e.startsWith("gauss-")?o=t*t+n*n:o=t*t-t*n+n*n,o<=2||o%2!==0)return"rgba(20, 20, 20, 1)";const s=ct(o),l=Math.log(o),r=240-s/(o/l**2)*120;return`hsl(${Math.max(0,Math.min(240,r))}, 90%, 55%)`}if(e.includes("ulam-")){const o=V(t,n);if(e==="ulam-green")return P(o)?"#00ff00":"transparent";if(o===1)return"black";if(P(o))return"#ffffff";const s=F(o);let l=Math.max(0,255-s*12);return l=Math.min(255,l),`rgb(${l},${Math.floor(l/2)},0)`}else if(e.includes("gauss-")){const o=t,s=n,l=o*o+s*s;if(e==="gauss-green")return Z(o,s)?"#00ff00":"transparent";{if(Z(o,s))return"#ffffff";if(l<=1)return"black";const r=F(l);let i=Math.max(0,255-r*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}else if(e.includes("eisen")){const o=t,s=n,l=o*o-o*s+s*s;if(e.includes("eisen-green"))return _(o,s)?"#00ff00":"transparent";{if(_(o,s))return"#ffffff";if(l<=1)return"black";const r=F(l);let i=Math.max(0,255-r*12);return i=Math.min(255,i),`rgb(${i},${Math.floor(i/2)},0)`}}return"transparent"}const E=5,ft=.05,ut=12;function S(){k.clear();const t=q.value,n=t.toLowerCase().includes("eisen"),e=-$/f,o=(X-$)/f,s=-g/f,l=(L-g)/f;if(n){const r=T,i=r*tt,a=r*2,[u,m]=D(e,s,r),[y,M]=D(o,s,r),[p,B]=D(e,l,r),[z,W]=D(o,l,r),G=Math.min(u,y,p,z)-E,mt=Math.max(u,y,p,z)+E,Mt=Math.min(m,M,B,W)-E,$t=Math.max(m,M,B,W)+E;for(let v=Math.floor(Mt);v<=Math.ceil($t);v++)for(let w=Math.floor(G);w<=Math.ceil(mt);w++){const[et,nt]=K(w,v,r);if(et>e-i&&et<o+i&&nt>s-a&&nt<l+a){const gt=`${w},${v}`;let ot,st,it;st=w*w-w*v+v*v,ot=`${w}${v>=0?"+":""}${v}ω`,it=at(w,v),k.set(gt,{x:w,y:v,label:ot,value:st,color:it})}}}else{const r=T,i=r,a=Math.floor(e/r)-E,u=Math.ceil(o/r)+E,m=Math.floor(s/i)-E,y=Math.ceil(l/i)+E;for(let M=m;M<=y;M++)for(let p=a;p<=u;p++){const B=`${p},${M}`;let z,W,G;t.toLowerCase().includes("ulam-")?(W=V(p,M),z=String(W)):(W=p*p+M*M,z=`${p}${M>=0?"+":""}${M}i`),G=at(p,M),k.set(B,{x:p,y:M,label:z,value:W,color:G})}}}function N(){c.clearRect(0,0,X*h,L*h),c.save(),c.translate($,g),c.scale(f,f);const t=q.value.toLowerCase();if(t.includes("gauss-"))c.strokeStyle="#666",c.lineWidth=1/f,c.beginPath(),c.moveTo(-X/f,0),c.lineTo(X/f,0),c.moveTo(0,-L/f),c.lineTo(0,L/f),c.stroke();else if(t.includes("eisen")){c.strokeStyle="#666",c.lineWidth=1/f,c.beginPath();const n=Math.max(X,L)/f,[e,o]=K(n,0,1);c.moveTo(-e,-o),c.lineTo(e,o);const[s,l]=K(0,n,1);c.moveTo(-s,-l),c.lineTo(s,l),c.stroke()}if(t.includes("eisen")){const n=T;for(const e of k.values()){const[o,s]=K(e.x,e.y,n);e.color!=="transparent"&&rt(c,o,s,n,e.color,null,null),rt(c,o,s,n,null,"rgba(0,0,0,0.2)",1/f)}}else{const n=T;for(const e of k.values())e.color!=="transparent"&&(c.fillStyle=e.color,c.fillRect(e.x*n,e.y*n,n,n),c.strokeStyle="rgba(0,0,0,0.2)",c.lineWidth=1/f,c.strokeRect(e.x*n,e.y*n,n,n))}c.restore()}function ht(){C||(Math.abs(x)>.1||Math.abs(b)>.1?($+=x,g+=b,x*=lt,b*=lt,S(),N()):Math.abs(x)<=.1&&Math.abs(b)<=.1&&(x!==0||b!==0)&&(x=0,b=0)),requestAnimationFrame(ht)}function vt(t,n){const e=q.value,o=(t/h-$)/f,s=(n/h-g)/f;if(e.toLowerCase().includes("eisen")){const[l,r]=D(o,s,T),i=`${l},${r}`;return k.get(i)}else{const l=Math.floor(o/T),r=Math.floor(s/T);return k.get(`${l},${r}`)}}function wt(t){if(C){d.style.display="none";const i=t.clientX-j,a=t.clientY-A;$=H+i*h,g=I+a*h,x=t.movementX*h,b=t.movementY*h,S(),N();return}const n=vt(t.clientX*h,t.clientY*h);if(!n){d.style.display="none";return}const e=q.value;let o="";if(e.toLowerCase().includes("-comet")){const i=n.value;let a=`n = ${i}`;if(e.startsWith("gauss-")?a=`${n.x}${n.y>=0?"+":""}${n.y}i
Norm = ${i}`:e.startsWith("eisen-")&&(a=`${n.x}${n.y>=0?"+":""}${n.y}ω
Norm = ${i}`),i<=2||i%2!==0)o=`${a}
(Odd or too small)`;else{const u=ct(i),m=pt(i),y=m>.1?u/m:0;o=`${a}
Goldbach Pairs: ${u}
Heuristic: ${m.toFixed(2)}
Ratio: ${y.toFixed(2)}`}}else if(e.toLowerCase().includes("ulam-")){const i=n.value,a=F(i),u=U(J(i));o=`n = ${i}
Factors (excluding 1,n): ${a}
Prime factorization:
${u}`}else if(e.toLowerCase().includes("gauss-")){const i=n.x,a=n.y,u=n.value,m=Z(i,a)?"Yes":"No",y=F(u),M=U(J(u));o=`${i}${a>=0?"+":""}${a}i
Gaussian prime: ${m}
Norm = ${u}
Norm factors (excl 1,norm): ${y}
Prime factorization of norm:
${M}`}else if(e.toLowerCase().includes("eisen")){const i=n.x,a=n.y,u=n.value,m=_(i,a)?"Yes":"No",y=F(u),M=U(J(u));o=`${i}${a>=0?"+":""}${a}ω
Eisenstein prime: ${m}
Norm = ${u}
Norm factors (excl 1,norm): ${y}
Prime factorization of norm:
${M}`}d.textContent=o,d.style.display="block";const s=12;let l=t.clientX+s,r=t.clientY+s;l+d.offsetWidth>window.innerWidth&&(l=t.clientX-d.offsetWidth-s),r+d.offsetHeight>window.innerHeight&&(r=t.clientY-d.offsetHeight-s),d.style.left=`${l}px`,d.style.top=`${r}px`}function xt(t){t.preventDefault();const n=t.clientX*h,e=t.clientY*h,o=-t.deltaY*.001;let s=f*(1+o);s=Math.min(Math.max(s,ft),ut);const l=(n-$)/f,r=(e-g)/f;$-=l*s-l*f,g-=r*s-r*f,f=s,S(),N()}function bt(t){C=!0,j=t.clientX,A=t.clientY,H=$,I=g,x=0,b=0,Y.style.cursor="grabbing",d.style.display="none"}function Yt(){C=!1,Y.style.cursor="grab"}function Xt(t){if(t.preventDefault(),t.touches.length===2){const n=t.touches[0],e=t.touches[1];Q=Math.hypot(e.clientX-n.clientX,e.clientY-n.clientY),O=f,C=!1,d.style.display="none"}else t.touches.length===1&&(C=!0,j=t.touches[0].clientX,A=t.touches[0].clientY,H=$,I=g,x=0,b=0,d.style.display="none")}function Lt(t){if(t.preventDefault(),t.touches.length===2&&Q>0){const n=t.touches[0],e=t.touches[1],o=Math.hypot(e.clientX-n.clientX,e.clientY-n.clientY),s=O*(o/Q);f=Math.min(Math.max(s,ft),ut);const l=(n.clientX+e.clientX)/2,r=(n.clientY+e.clientY)/2,i=(l*h-H)/O,a=(r*h-I)/O,u=(l*h-$)/f,m=(r*h-g)/f;$+=(u-i)*f,g+=(m-a)*f,S(),N()}else if(C&&t.touches.length===1){const n=t.touches[0].clientX-j,e=t.touches[0].clientY-A;$=H+n*h,g=I+e*h,t.touches[0].previousClientX!==void 0&&(x=(t.touches[0].clientX-t.touches[0].previousClientX)*h,b=(t.touches[0].clientY-t.touches[0].previousClientY)*h),S(),N()}}function Ct(t){Q=-1,t.touches.length===0?C=!1:t.touches.length===1&&(C=!0,j=t.touches[0].clientX,A=t.touches[0].clientY,H=$,I=g)}function dt(){X=window.innerWidth,L=window.innerHeight,Y.style.width=`${X}px`,Y.style.height=`${L}px`,Y.width=X*h,Y.height=L*h,c.setTransform(h,0,0,h,0,0),$===0&&g===0&&($=X*h/2,g=L*h/2),S(),N()}q.addEventListener("change",()=>{k.clear(),S(),N()});Y.addEventListener("wheel",xt,{passive:!1});Y.addEventListener("mousedown",bt);window.addEventListener("mousemove",wt);window.addEventListener("mouseup",Yt);Y.addEventListener("touchstart",Xt,{passive:!1});window.addEventListener("touchmove",Lt,{passive:!1});window.addEventListener("touchend",Ct);window.addEventListener("resize",dt);dt();ht();
//# sourceMappingURL=ulam2.js.map
